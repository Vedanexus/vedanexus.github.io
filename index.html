<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Game Test</title>

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
}
body{
  background:url("bg.jpg") center/cover no-repeat fixed;
}
canvas{
  display:block;
}
</style>
</head>

<body>

<canvas id="game"></canvas>

<script>
/* BASIC SETUP */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* PLAYER */
const player = {
  x: canvas.width/2 - 20,
  y: canvas.height - 80,
  w: 40,
  h: 40
};

/* BULLETS & ENEMIES */
let bullets = [];
let enemies = [];

/* INPUT */
document.addEventListener("pointerdown", e=>{
  bullets.push({
    x: player.x + player.w/2 - 3,
    y: player.y,
    w: 6,
    h: 12,
    v: 10
  });
});

/* SPAWN ENEMY */
setInterval(()=>{
  enemies.push({
    x: Math.random() * (canvas.width - 40),
    y: -40,
    w: 40,
    h: 40,
    v: 3
  });
}, 800);

/* COLLISION */
function hit(a,b){
  return a.x < b.x+b.w &&
         a.x+a.w > b.x &&
         a.y < b.y+b.h &&
         a.y+a.h > b.y;
}

/* LOOP */
function loop(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  /* PLAYER */
  ctx.fillStyle = "white";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  /* BULLETS */
  bullets.forEach(b=>{
    b.y -= b.v;
    ctx.fillRect(b.x, b.y, b.w, b.h);
  });

  /* ENEMIES */
  enemies.forEach(e=>{
    e.y += e.v;
    ctx.fillStyle = "red";
    ctx.fillRect(e.x, e.y, e.w, e.h);
  });

  /* HIT CHECK */
  bullets.forEach((b,bi)=>{
    enemies.forEach((e,ei)=>{
      if(hit(b,e)){
        bullets.splice(bi,1);
        enemies.splice(ei,1);
      }
    });
  });

  bullets = bullets.filter(b=>b.y>-20);
  enemies = enemies.filter(e=>e.y<canvas.height+40);

  requestAnimationFrame(loop);
}
loop();
</script>

</body>
</html>
