<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
<title>Dodge Rush</title>

<style>
html, body {
  margin: 0;
  padding: 0;
  background: radial-gradient(circle at top, #0f2027, #000);
  overflow: hidden;
  touch-action: none;
  font-family: system-ui, sans-serif;
}
canvas { display: block; }
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

let W, H;
function resize(){
  W = canvas.width = window.innerWidth;
  H = canvas.height = window.innerHeight;
}
window.addEventListener("resize", resize);
resize();

/* ===== PLAYER ===== */
const player = {
  x: W/2,
  y: H - 80,
  r: 14
};

/* ===== BLOCKS ===== */
let blocks = [];
let speed = 3;
let score = 0;
let gameOver = false;

/* ===== INPUT ===== */
let dragging = false;

document.addEventListener("pointerdown", e => {
  if(gameOver){
    restart();
    return;
  }
  dragging = true;
  player.x = e.clientX;
});

document.addEventListener("pointermove", e => {
  if(dragging){
    player.x = e.clientX;
  }
});

document.addEventListener("pointerup", () => dragging = false);

/* ===== SPAWN ===== */
function spawnBlock(){
  blocks.push({
    x: Math.random() * (W-40),
    y: -40,
    w: 40,
    h: 40
  });
}

/* ===== RESTART ===== */
function restart(){
  blocks = [];
  speed = 3;
  score = 0;
  gameOver = false;
}

/* ===== LOOP ===== */
function update(){
  if(gameOver) return;

  if(Math.random() < 0.03){
    spawnBlock();
  }

  for(let b of blocks){
    b.y += speed;

    // collision
    if(
      Math.hypot(player.x - (b.x+b.w/2), player.y - (b.y+b.h/2))
      < player.r + 20
    ){
      gameOver = true;
    }
  }

  blocks = blocks.filter(b => b.y < H+50);

  speed += 0.002;
  score++;
}

function draw(){
  ctx.clearRect(0,0,W,H);

  // blocks
  ctx.fillStyle = "#ff3b3b";
  blocks.forEach(b => ctx.fillRect(b.x,b.y,b.w,b.h));

  // player
  ctx.beginPath();
  ctx.arc(player.x, player.y, player.r, 0, Math.PI*2);
  ctx.fillStyle = "#00f5d4";
  ctx.shadowBlur = 20;
  ctx.shadowColor = "#00f5d4";
  ctx.fill();

  // score
  ctx.shadowBlur = 0;
  ctx.fillStyle = "#fff";
  ctx.font = "16px system-ui";
  ctx.fillText("Score: "+score, 10, 20);

  if(gameOver){
    ctx.fillText("GAME OVER - TAP TO RESTART", W/2-120, H/2);
  }
}

function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
