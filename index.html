<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Working Game</title>

<style>
html,body{
  margin:0;
  padding:0;
  overflow:hidden;
  background:#111;
}
canvas{
  display:block;
}
</style>
</head>

<body>
<canvas id="game"></canvas>

<script>
/* ===== CANVAS ===== */
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

function resize(){
  canvas.width = window.innerWidth;
  canvas.height = window.innerHeight;
}
resize();
window.addEventListener("resize", resize);

/* ===== PLAYER ===== */
const player = {
  x: canvas.width/2 - 20,
  y: canvas.height - 80,
  w: 40,
  h: 40,
  alive: true
};

/* ===== ARRAYS ===== */
let bullets = [];
let enemies = [];

/* ===== INPUT ===== */
window.addEventListener("pointermove", e=>{
  player.x = e.clientX - player.w/2;
});

window.addEventListener("pointerdown", ()=>{
  bullets.push({
    x: player.x + player.w/2 - 3,
    y: player.y,
    w: 6,
    h: 12,
    speed: 8
  });
});

/* ===== ENEMY SPAWN ===== */
setInterval(()=>{
  enemies.push({
    x: Math.random() * (canvas.width - 40),
    y: -40,
    w: 40,
    h: 40,
    speed: 2
  });
},1000);

/* ===== COLLISION ===== */
function hit(a,b){
  return (
    a.x < b.x + b.w &&
    a.x + a.w > b.x &&
    a.y < b.y + b.h &&
    a.y + a.h > b.y
  );
}

/* ===== UPDATE ===== */
function update(){
  if(!player.alive) return;

  bullets.forEach(b => b.y -= b.speed);
  enemies.forEach(e => e.y += e.speed);

  // bullet vs enemy
  for(let i=bullets.length-1;i>=0;i--){
    for(let j=enemies.length-1;j>=0;j--){
      if(hit(bullets[i], enemies[j])){
        bullets.splice(i,1);
        enemies.splice(j,1);
        break;
      }
    }
  }

  // enemy vs player
  for(let i=0;i<enemies.length;i++){
    if(hit(enemies[i], player)){
      player.alive = false;
    }
  }

  bullets = bullets.filter(b => b.y > -20);
  enemies = enemies.filter(e => e.y < canvas.height + 40);
}

/* ===== DRAW ===== */
function draw(){
  ctx.clearRect(0,0,canvas.width,canvas.height);

  if(!player.alive){
    ctx.fillStyle="white";
    ctx.font="48px Arial";
    ctx.textAlign="center";
    ctx.fillText("GAME OVER", canvas.width/2, canvas.height/2);
    return;
  }

  // player
  ctx.fillStyle="cyan";
  ctx.fillRect(player.x, player.y, player.w, player.h);

  // bullets
  ctx.fillStyle="yellow";
  bullets.forEach(b=>{
    ctx.fillRect(b.x,b.y,b.w,b.h);
  });

  // enemies
  ctx.fillStyle="red";
  enemies.forEach(e=>{
    ctx.fillRect(e.x,e.y,e.w,e.h);
  });
}

/* ===== LOOP ===== */
function loop(){
  update();
  draw();
  requestAnimationFrame(loop);
}
loop();
</script>
</body>
</html>
